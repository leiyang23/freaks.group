(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1928dacd"],{"40ad":function(e,t,s){},e95f:function(e,t,s){"use strict";var n=s("40ad"),o=s.n(n);o.a},fb60:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("div",{staticClass:"shell"},[s("div",{staticClass:"txt"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.con,expression:"con"}],attrs:{id:"shell",readonly:""},domProps:{value:e.con},on:{input:function(t){t.target.composing||(e.con=t.target.value)}}})]),s("div",{staticClass:"ipt"},[e.conn_status?s("el-input",{staticClass:"input",attrs:{placeholder:"按回车键发送命令"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.ws_send(t)}},model:{value:e.send_message,callback:function(t){e.send_message=t},expression:"send_message"}}):s("el-button",{on:{click:function(t){e.dialogVisible=!0}}},[e._v("连接")])],1)]),s("el-dialog",{attrs:{title:"连接到远程机器","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,center:!0,visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{attrs:{model:e.conn_info}},[s("el-form-item",{attrs:{label:"IP","label-width":"100px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.conn_info.host,callback:function(t){e.$set(e.conn_info,"host",t)},expression:"conn_info.host"}})],1),s("el-form-item",{attrs:{label:"端口","label-width":"100px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.conn_info.port,callback:function(t){e.$set(e.conn_info,"port",t)},expression:"conn_info.port"}})],1),s("el-form-item",{attrs:{label:"用户名","label-width":"100px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.conn_info.username,callback:function(t){e.$set(e.conn_info,"username",t)},expression:"conn_info.username"}})],1),s("el-form-item",{attrs:{label:"密码","label-width":"100px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.conn_info.password,callback:function(t){e.$set(e.conn_info,"password",t)},expression:"conn_info.password"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",icon:e.iconName},on:{click:e.init_conn}},[e._v("连接")])],1)],1)],1)},o=[],i=s("2daa"),a={name:"Terminal",data:function(){return{input_history:[],iconName:"",socket:"",ws_path:i["b"]+"/ws/monitor/terminal",send_message:"",con:"",conn_status:!1,dialogVisible:!0,conn_info:{host:"47.111.175.222",port:22,username:"root",password:"1005931665Ecs"}}},mounted:function(){this.init();var e=this,t=0,s=setInterval((function(){1!==e.socket.readyState?(e.init(),t++,t>3&&clearInterval(s)):clearInterval(s)}),15e3)},methods:{handleClose:function(e){this.$message.error("未连接！"),e()},init_conn:function(){this.iconName="el-icon-loading",this.socket.send(JSON.stringify({conn_info:this.conn_info,message:"init_conn"}))},previous:function(){this.send_message=this.input_history[0]},querySearch:function(e,t){for(var s=[],n=0;n<this.input_history.length;n++)s.push({value:this.input_history[n]});t(s)},handleSelect:function(e){this.send_message=e.value,this.ws_send()},scroll_to_bottom:function(){var e=document.getElementById("shell");e.scrollTop=e.scrollHeight},init:function(){"undefined"===typeof WebSocket?this.$message.error("浏览器不支持 websocket !"):(this.socket=new WebSocket(this.ws_path),this.socket.onopen=this.ws_open,this.socket.onerror=this.ws_error,this.socket.onmessage=this.ws_get_message,this.socket.onclose=this.ws_close)},ws_open:function(){window.console.log("conn success")},ws_error:function(){window.console.log("conn err"),this.conn_status=!1,this.$notify.error({title:"错误",message:"连接出现错误！",duration:3e3})},ws_get_message:function(e){var t=this,s=JSON.parse(e.data);if("status"in s){if("bad"===s.status)return t.iconName="",t.dialogVisible=!0,void t.$message.error(s.message);if("ok"===s.status)return t.conn_status=!0,t.dialogVisible=!1,void t.$message.success(s.message)}this.con=this.con+s.message,setTimeout((function(){t.scroll_to_bottom()}),200)},ws_close:function(){window.console.warn("conn close"),this.conn_status=!1},ws_send:function(){this.socket.send(JSON.stringify({message:this.send_message})),this.input_history.unshift(this.send_message),this.input_history.length>5&&this.input_history.pop(),this.send_message=""}},destroyed:function(){this.socket.close()}},c=a,l=(s("e95f"),s("2877")),r=Object(l["a"])(c,n,o,!1,null,"17b37a62",null);t["default"]=r.exports}}]);
//# sourceMappingURL=chunk-1928dacd.20f29626.js.map